import React, { useEffect, useLayoutEffect, useRef, useState } from 'react';

// SVG path data (split by kanji/latin/number stroke group, in logo SVG order)
const paths = [
  {
    // 由
    d: "M29.5364 5.6C30.403 5 31.003 4.7 31.3364 4.7C31.6697 4.63333 32.403 4.8 33.5364 5.2C34.6697 5.66667 35.5364 6.4 36.1364 7.4C36.803 8.4 37.4364 9.3 38.0364 10.1C38.6364 10.6333 38.9364 11.0667 38.9364 11.4C38.9364 11.7333 38.7697 12.4333 38.4364 13.5C37.8364 14.9 37.5364 17.6667 37.5364 21.8C37.5364 25.2 37.6697 27.1667 37.9364 27.7C38.2697 28.2333 39.303 28.5 41.0364 28.5C42.2364 28.5 43.5697 28.7 45.0364 29.1C48.7697 30.1667 52.603 30.7 56.5364 30.7C58.1364 30.7 60.3697 31.2667 63.2364 32.4C66.1697 33.5333 68.0364 34.5667 68.8364 35.5C69.1697 35.9 69.3364 36.9 69.3364 38.5C69.3364 40.1 69.1697 41.7 68.8364 43.3C68.503 44.7667 68.2364 46.9333 68.0364 49.8C67.903 52.6 67.603 54.5 67.1364 55.5C66.7364 56.5 66.5364 57.3333 66.5364 58C66.5364 58.6667 66.203 60.2 65.5364 62.6C64.9364 65 64.5364 66.8 64.3364 68C63.9364 70 63.103 71.9667 61.8364 73.9L59.9364 77.3C58.9364 79.0333 58.103 80.2 57.4364 80.8C56.8364 81.3333 56.303 82.0333 55.8364 82.9C55.3697 83.8333 54.8697 84.6 54.3364 85.2C52.2697 87.4 50.8364 88.6333 50.0364 88.9C49.303 89.1667 48.3364 88.6667 47.1364 87.4C46.403 86.6667 45.403 85.9 44.1364 85.1C42.8697 84.3667 41.9364 84 41.3364 84C41.003 84 40.5364 83.5 39.9364 82.5C39.403 81.5667 39.0364 80.7 38.8364 79.9C38.6364 79.1667 38.8697 78.7 39.5364 78.5C40.7364 78.1667 40.4364 77.9 38.6364 77.7C37.503 77.5 35.703 77.3667 33.2364 77.3C29.703 77.0333 27.1364 77 25.5364 77.2C24.003 77.4 22.3364 77.9333 20.5364 78.8C19.403 79.2667 18.603 79.7667 18.1364 80.3C17.6697 80.7667 17.003 81.8333 16.1364 83.5C15.5364 84.5667 15.103 85.2 14.8364 85.4C14.5697 85.6667 14.0697 85.8 13.3364 85.8C12.0697 85.8 11.0364 85.5 10.2364 84.9C9.43636 84.3667 8.63636 83.3667 7.83636 81.9C6.90303 80.1667 6.33636 77.9667 6.13636 75.3C6.00303 72.6333 5.7697 71.1 5.43636 70.7C5.1697 70.3 5.0697 68.6333 5.13636 65.7C5.20303 62.7 5.0697 60.1333 4.73636 58L3.53636 50.3C3.0697 47.3 2.60303 45.3333 2.13636 44.4C1.6697 43.4 1.43636 42.4667 1.43636 41.6C1.43636 40.6667 1.20303 39.6333 0.736364 38.5C0.136364 37.1 -0.0969699 36.2 0.0363638 35.8C0.236363 35.4 0.869696 35.2 1.93636 35.2C3.2697 35.2 4.83636 34.7667 6.63636 33.9C10.0364 32.1 14.3364 30.6667 19.5364 29.6L25.0364 28.6L26.4364 28.3L26.8364 19.8C27.0364 14.2667 27.2697 11.1 27.5364 10.3C27.8697 9.43333 28.0364 8.56666 28.0364 7.7C28.0364 6.83333 28.5364 6.13333 29.5364 5.6ZM26.4364 33.3L24.7364 33.1C23.8697 33.1 21.803 33.4667 18.5364 34.2C15.2697 34.9333 12.9697 35.6 11.6364 36.2C10.503 36.6 9.80303 37 9.53636 37.4C9.33636 37.7333 9.50303 38.3333 10.0364 39.2C11.1697 41.5333 11.8364 43.1 12.0364 43.9C12.303 44.7 12.403 45.8333 12.3364 47.3C12.2697 50.3667 12.603 51.9 13.3364 51.9C13.5364 51.9 13.6364 51.6333 13.6364 51.1C13.6364 50.5667 14.0697 49.9 14.9364 49.1C15.8697 48.3 16.703 47.8667 17.4364 47.8C22.8364 46.7333 25.603 46.1 25.7364 45.9C26.0697 45.6333 26.2697 43.0333 26.3364 38.1L26.4364 33.3ZM48.2364 35C41.7697 33 38.3364 32.5 37.9364 33.5C37.803 33.9 37.7364 35.7333 37.7364 39L37.5364 43.9L39.9364 43.6C41.4697 43.4 42.903 43.5 44.2364 43.9C45.5697 44.2333 46.303 44.7667 46.4364 45.5C46.6364 46.2333 46.6364 46.7667 46.4364 47.1C46.2364 47.3667 46.3697 47.7667 46.8364 48.3C47.1697 48.7 47.303 49.0667 47.2364 49.4C47.2364 49.7333 47.0364 50.3667 46.6364 51.3C45.3697 53.9 43.7364 54.8667 41.7364 54.2C40.603 53.9333 39.503 53.8 38.4364 53.8H36.8364L36.7364 58.4C36.7364 61.4 36.5697 63.4667 36.2364 64.6C35.9697 65.6667 35.7697 66.6 35.6364 67.4L35.4364 68.6H38.3364C41.4697 68.6 43.4697 69.3333 44.3364 70.8C44.803 71.5333 44.4697 73.3 43.3364 76.1C43.0697 76.6333 43.2697 76.8667 43.9364 76.8C44.403 76.8 45.1364 76.6333 46.1364 76.3C46.8697 76.1 47.403 75.8 47.7364 75.4C48.1364 74.9333 48.6697 74.0667 49.3364 72.8C51.3364 68.3333 52.7697 64.0667 53.6364 60C54.5697 55.9333 55.203 50.6 55.5364 44L55.7364 38L54.6364 37.3C53.903 36.9 51.7697 36.1333 48.2364 35ZM25.6364 55.8C25.6364 55.2667 25.5697 54.9333 25.4364 54.8C25.303 54.6 25.003 54.4667 24.5364 54.4C23.803 54.2667 22.9697 54.4333 22.0364 54.9C21.103 55.3667 20.3697 55.6 19.8364 55.6C19.303 55.6 18.5364 56 17.5364 56.8C16.5364 57.6 15.703 58.2667 15.0364 58.8C14.6364 59.0667 14.403 59.3333 14.3364 59.6C14.2697 59.8 14.3697 60.2 14.6364 60.8C14.9697 61.7333 15.2364 63.1667 15.4364 65.1C15.703 67.0333 15.9697 68.6333 16.2364 69.9C16.3697 70.7 16.5364 71.2 16.7364 71.4C17.003 71.5333 17.4697 71.6 18.1364 71.6C19.203 71.6 20.603 71.4 22.3364 71L24.7364 70.5L25.1364 63.8L25.6364 55.8Z",
    color: '#000',
    duration: 800
  },
  {
    // 奈
    d: "M139.536 70.3C139.27 69.8333 140.803 69.8333 144.136 70.3C145.803 70.5667 147.17 70.7333 148.236 70.8C149.303 70.8 149.836 70.9333 149.836 71.2C149.836 71.4 150.603 71.7667 152.136 72.3C156.403 73.9667 157.87 76.3 156.536 79.3C155.67 81.3667 154.37 82.4667 152.636 82.6C151.703 82.6667 150.97 82.6 150.436 82.4C149.903 82.2 149.27 81.7333 148.536 81C147.803 80.3333 146.836 79.5333 145.636 78.6C144.436 77.6 142.97 76.2333 141.236 74.5C139.503 72.7 138.636 71.7 138.636 71.5C138.636 71.2333 138.803 71.0333 139.136 70.9C139.536 70.7 139.67 70.5 139.536 70.3ZM111.936 69C112.67 68.1333 113.17 67.8 113.436 68C113.703 68.2 113.836 68.9667 113.836 70.3C113.77 71.6333 113.87 72.5667 114.136 73.1C114.403 73.6333 114.636 74.9667 114.836 77.1C115.036 80.7667 114.17 83.3 112.236 84.7C111.436 85.2333 110.736 85.4333 110.136 85.3C109.536 85.2333 108.87 84.7667 108.136 83.9C107.603 83.1667 107.27 82.5667 107.136 82.1C107.07 81.6333 107.036 80.6 107.036 79C107.103 77.5333 107.17 76.5333 107.236 76C107.37 75.4 107.67 74.7667 108.136 74.1C109.803 71.6333 111.07 69.9333 111.936 69ZM139.036 53.2C140.436 53.2 141.403 53.1 141.936 52.9C142.47 52.6333 143.303 52.5333 144.436 52.6C145.17 52.6 145.703 52.7 146.036 52.9C146.37 53.1 146.836 53.6 147.436 54.4C149.57 57.3333 149.203 59.1 146.336 59.7C145.47 59.8333 144.736 60.1 144.136 60.5C143.603 60.9 142.87 60.9333 141.936 60.6C141.07 60.2667 139.17 60.2667 136.236 60.6C132.503 61 130.603 61.3333 130.536 61.6C130.536 61.7333 130.97 62.2333 131.836 63.1L133.336 64.8L133.436 72.1L133.736 83.1C133.736 85.5 133.57 86.8333 133.236 87.1C132.903 87.4333 132.736 87.9333 132.736 88.6C132.736 89.2667 132.436 89.9 131.836 90.5C131.236 91.1 130.836 91.7 130.636 92.3C130.503 92.9667 130.136 93.3667 129.536 93.5C129.003 93.7 128.036 93.7667 126.636 93.7C125.436 93.6333 124.703 93.5333 124.436 93.4C124.236 93.2667 124.036 92.9 123.836 92.3C123.57 91.4333 122.803 90.3 121.536 88.9C120.27 87.5667 119.636 86.6667 119.636 86.2C119.636 85.7333 119.103 85.1667 118.036 84.5C116.703 83.4333 116.036 82.6333 116.036 82.1C116.036 81.8333 116.67 82.0333 117.936 82.7C119.203 83.3667 120.636 83.7 122.236 83.7C124.036 83.7667 125.103 83.4333 125.436 82.7C125.77 82.0333 125.936 79.6 125.936 75.4C126.003 70.6 125.903 67.3333 125.636 65.6C125.503 64.3333 125.336 63.6 125.136 63.4C125.003 63.1333 124.703 63.0667 124.236 63.2C123.236 63.4667 122.103 63.8667 120.836 64.4C119.636 64.8667 118.87 65.2333 118.536 65.5C118.203 65.8333 117.87 66 117.536 66C117.136 66 115.703 65.6333 113.236 64.9C110.836 64.1 109.57 63.6 109.436 63.4C108.836 62.8 110.036 61.7667 113.036 60.3C118.97 57.5 125.736 55.3667 133.336 53.9C135.603 53.5 137.503 53.2667 139.036 53.2ZM130.836 40.6C132.303 40.2 133.87 40.3 135.536 40.9C136.403 41.1667 136.87 41.8 136.936 42.8C137.07 43.8 136.803 44.9667 136.136 46.3C135.603 47.1667 135.103 47.7667 134.636 48.1C134.236 48.4333 133.57 48.5333 132.636 48.4C131.636 48.3333 129.97 48.5333 127.636 49C124.77 49.5333 122.77 49.8 121.636 49.8C120.503 49.7333 119.503 49.4 118.636 48.8C118.036 48.3333 117.67 47.9667 117.536 47.7C117.47 47.4333 117.536 47.0333 117.736 46.5C118.003 45.6333 118.27 45.0667 118.536 44.8C118.87 44.5333 119.87 44.0667 121.536 43.4C123.27 42.7333 124.936 42.2 126.536 41.8C128.203 41.3333 129.636 40.9333 130.836 40.6ZM126.936 0.699997C128.136 0.233332 128.77 0 128.836 0C128.903 0 129.236 0.199999 129.836 0.599998C130.503 0.999997 131.17 2.23333 131.836 4.3C132.37 5.9 132.636 7.1 132.636 7.9C132.636 8.63333 132.37 9.26666 131.836 9.8C131.503 10.2 131.07 11.2333 130.536 12.9C130.003 14.5667 129.736 15.7667 129.736 16.5C129.736 16.9 130.27 17.1 131.336 17.1C132.403 17.1 134.37 16.9 137.236 16.5C140.103 16.0333 142.27 15.6333 143.736 15.3C145.203 14.9667 147.003 14.8 149.136 14.8C150.536 14.8 151.436 14.8333 151.836 14.9C152.303 14.9667 152.736 15.2 153.136 15.6C153.67 16.2 154.07 17.0333 154.336 18.1C154.603 19.1667 154.57 19.9667 154.236 20.5C153.836 21.1667 153.203 21.8 152.336 22.4C151.536 23 150.836 23.3 150.236 23.3C149.503 23.3 148.603 22.9333 147.536 22.2C146.803 21.7333 146.136 21.4333 145.536 21.3C144.936 21.1667 143.67 21.1 141.736 21.1C138.603 20.9667 137.003 21.1333 136.936 21.6C136.936 21.9333 137.503 22.7 138.636 23.9C143.503 29.0333 145.936 31.7333 145.936 32C145.936 32.2 146.836 33.2333 148.636 35.1C150.436 36.9667 151.503 38.1667 151.836 38.7C152.17 39.1667 153.303 40.2 155.236 41.8C157.236 43.4 158.97 44.6333 160.436 45.5C161.97 46.5667 163.703 47.4667 165.636 48.2C168.236 49.1333 170.536 50.0333 172.536 50.9C174.203 51.6333 175.136 52 175.336 52C175.603 52 176.47 52.5333 177.936 53.6C179.403 54.6667 180.27 55.3333 180.536 55.6C180.87 56.1333 180.836 56.6 180.436 57C180.036 57.4 179.37 57.6667 178.436 57.8C174.97 58.1333 172.103 58.9333 169.836 60.2C168.37 61 167.37 61.4 166.836 61.4C166.303 61.4 165.036 60.9333 163.036 60C161.103 59 159.603 58.1 158.536 57.3C157.403 56.3667 156.67 55.9 156.336 55.9C156.07 55.9 155.136 55.3 153.536 54.1C152.003 52.9 150.803 51.8333 149.936 50.9C146.803 47.7 145.236 45.9333 145.236 45.6C145.236 45.4667 144.503 44.4 143.036 42.4C140.036 38.4 138.07 35.5333 137.136 33.8C137.003 33.4667 136.303 32.2 135.036 30C133.77 27.8 133.136 26.6 133.136 26.4C133.136 26.1333 132.803 25.4 132.136 24.2C131.47 23 131.036 22.3667 130.836 22.3C130.57 22.1667 129.97 22.1667 129.036 22.3C128.17 22.4333 127.603 22.8333 127.336 23.5C127.07 24.1 126.603 24.9333 125.936 26C125.27 27.0667 124.936 27.7333 124.936 28C124.936 28.2667 124.536 29.2667 123.736 31C123.003 32.6667 122.636 33.6 122.636 33.8C122.636 33.9333 122.336 34.3333 121.736 35C121.136 35.6667 120.57 36.6 120.036 37.8C119.703 38.5333 118.27 40.3 115.736 43.1C113.27 45.9 111.203 48.0333 109.536 49.5L107.536 51.3C106.87 51.9667 105.936 52.5667 104.736 53.1C103.603 53.6333 102.37 54.4 101.036 55.4C99.7697 56.4 98.3697 57.3333 96.8364 58.2C91.503 61.2667 88.7364 62.5333 88.5364 62C88.4697 61.9333 88.4364 61.8667 88.4364 61.8C88.4364 61.5333 88.5697 61.4 88.8364 61.4C89.103 61.4 89.2364 61.2667 89.2364 61C89.2364 60.2 92.9697 56.7 100.436 50.5C101.636 49.5 103.103 48 104.836 46C106.57 43.9333 107.636 42.4333 108.036 41.5C108.37 40.9 109.036 39.8333 110.036 38.3C111.036 36.7667 111.703 35.8 112.036 35.4C112.436 35 113.47 33 115.136 29.4C116.87 25.8 117.67 23.9333 117.536 23.8C117.47 23.7333 116.803 23.8667 115.536 24.2C114.27 24.4667 113.336 24.8 112.736 25.2C112.136 25.4667 111.703 25.6 111.436 25.6C111.236 25.5333 110.77 25.3 110.036 24.9C109.17 24.3 108.736 23.9667 108.736 23.9C108.736 23.7667 108.87 23.4 109.136 22.8C109.336 22.1333 109.803 21.6667 110.536 21.4C111.27 21.0667 112.97 20.5333 115.636 19.8L119.736 18.8L120.536 17.1C121.736 14.7 122.67 12.0333 123.336 9.1C123.736 7.03333 124.136 5.2 124.536 3.6C124.87 2.53333 125.136 1.86666 125.336 1.6C125.603 1.26666 126.136 0.966664 126.936 0.699997Z",
    color: '#000',
    duration: 800
  },
  {
    // m3 body (svg paths 3+4)
    d: "M219.336 42.4C219.336 41.6 219.27 41.2 219.136 41.2C218.87 41.2 218.57 41.7333 218.236 42.8C217.036 45.8667 214.236 55.4333 209.836 71.5C209.17 73.8333 208.47 75 207.736 75C207.403 75 206.803 74.7333 205.936 74.2C202.536 71.7333 200.836 68.7 200.836 65.1C200.836 62.2333 201.303 58.3333 202.236 53.4C203.303 47.2667 203.836 43.9667 203.836 43.5C203.836 42.9667 203.736 42.7 203.536 42.7C203.403 42.7 203.17 43.0333 202.836 43.7C199.436 51.8333 197.37 61.5333 196.636 72.8C196.503 74.8 195.836 75.8 194.636 75.8C193.036 75.8 191.603 74.8667 190.336 73C188.003 69.6667 186.836 65.9333 186.836 61.8C186.836 59.2 187.136 55.9 187.736 51.9C188.403 47.9 188.803 45.4667 188.936 44.6C190.07 37.6 191.103 34.1 192.036 34.1C192.77 34.1 193.336 35.0667 193.736 37C194.136 38.8667 194.336 40.2333 194.336 41.1C194.336 41.9667 194.47 42.4 194.736 42.4C195.47 42.4 196.203 41.6333 196.936 40.1C197.67 38.5 198.57 36.9333 199.636 35.4C200.703 33.8 202.003 33 203.536 33C205.136 33 206.603 33.6 207.936 34.8C209.27 35.9333 210.103 37.3333 210.436 39C211.236 37.8667 212.57 36.3 214.436 34.3C215.436 32.9 216.436 32.2 217.436 32.2C218.503 32.2 220.036 32.7 222.036 33.7C224.77 35.1 226.136 38.7667 226.136 44.7C226.136 50.6333 225.936 55.7333 225.536 60V60.7C225.536 61.7 225.736 62.2 226.136 62.2C226.736 62.2 228.203 60.5333 230.536 57.2C232.87 53.8 234.303 52.1 234.836 52.1C235.77 52.1 236.236 54.5 236.236 59.3C236.236 64.0333 234.536 68.7667 231.136 73.5C229.536 75.7 228.17 76.8 227.036 76.8L225.936 76.5C223.27 75.1 221.37 73.5 220.236 71.7C219.103 69.9 218.536 67.0333 218.536 63.1L219.336 42.4Z",
    color: '#000',
    duration: 800
  },
  {
    // m3 highlight (gold)
    d: "M244.799 34.1C244.799 33.5667 244.899 33.2333 245.099 33.1C245.366 32.9 245.666 32.7333 245.999 32.6C246.399 32.4 246.632 32.2667 246.699 32.2C252.699 29 256.999 24.2 259.599 17.8C259.799 17.4 259.899 16.8667 259.899 16.2C259.899 15.2 259.032 14.7 257.299 14.7C256.499 14.7 255.866 14.7333 255.399 14.8C255.266 16.8 253.399 18.5667 249.799 20.1C246.266 21.5667 244.266 22.3 243.799 22.3C241.666 22.3 240.599 20.1667 240.599 15.9L240.899 11.1C240.966 9.7 241.632 8.7 242.899 8.1C245.099 7.23333 247.466 6.46667 249.999 5.8C249.799 5.26667 249.699 4.73333 249.699 4.2C249.699 3.66667 249.866 3.4 250.199 3.4C250.599 3.4 250.932 3.5 251.199 3.7C251.466 3.83333 251.766 4.13333 252.099 4.6C252.432 5 252.666 5.26667 252.799 5.4C253.466 5.26667 254.466 5.2 255.799 5.2C258.332 5.2 260.866 6.46666 263.399 9C263.799 9.4 264.299 10.1 264.899 11.1C265.566 12.1 266.099 12.8333 266.499 13.3C268.032 15.0333 268.799 17.2667 268.799 20C268.799 22.6667 268.032 25.4667 266.499 28.4C264.966 31.3333 263.399 33.7667 261.799 35.7C260.266 37.5667 259.499 38.6667 259.499 39C259.499 39.3333 260.366 40.3667 262.099 42.1C263.899 43.8333 265.699 46.1333 267.499 49C269.299 51.8667 270.199 54.6667 270.199 57.4C270.199 60.1333 269.532 62.8333 268.199 65.5C265.132 71.6333 259.466 75.6 251.199 77.4C250.199 77.6 249.266 77.7 248.399 77.7C247.599 77.7 246.799 77.6 245.999 77.4C245.266 77.2 244.632 76.8333 244.099 76.3C243.566 75.7667 243.066 75.3 242.599 74.9C242.199 74.5 241.866 73.8333 241.599 72.9C241.332 71.9667 241.099 71.2667 240.899 70.8C240.699 70.3333 240.532 69.5 240.399 68.3C240.266 67.1 240.199 66.3333 240.199 66C239.999 64.1333 239.899 62.5333 239.899 61.2V60.6C239.899 58.9333 240.866 57.8667 242.799 57.4C243.999 57.1333 245.699 56.8667 247.899 56.6C250.099 56.2667 251.466 56.0333 251.999 55.9C252.599 55.7667 253.032 55.7 253.299 55.7C253.566 55.7 253.699 55.9667 253.699 56.5C253.699 56.9667 253.066 58.1 251.799 59.9C250.532 61.7 249.899 62.7 249.899 62.9C249.899 63.0333 249.999 63.1 250.199 63.1C250.466 63.1 250.899 63 251.499 62.8C257.166 60.8 259.999 57.7 259.999 53.5C259.999 51.5 259.199 49.7 257.599 48.1C256.066 46.4333 254.299 45.6 252.299 45.6C251.566 45.6 250.499 45.9 249.099 46.5C247.699 47.0333 246.699 47.3 246.099 47.3C245.499 47.3 245.132 46.8667 244.999 46C244.932 45.1333 244.899 43.6667 244.899 41.6L244.799 34.1Z",
    color: '#B09A75',
    duration: 800
  },
];

export default function YunaM3LogoAnimated({ style, className }) {
  const pathsRef = useRef([]);
  const [lengths, setLengths] = useState([0, 0, 0, 0]); // measure before first paint
  const [cycle, setCycle] = useState(0);                // forces a clean replay

  const [strokesAnimated, setStrokesAnimated] = useState([false, false, false, false]);
  const [fillsVisible, setFillsVisible] = useState([false, false, false, false]);

  // Get path lengths before first paint to avoid initial "already drawn" flash
  useLayoutEffect(() => {
    if (pathsRef.current.every(Boolean)) {
      const L = pathsRef.current.map(p => p.getTotalLength());
      setLengths(L);
    }
  }, []);

  useEffect(() => {
  if (!lengths.every(n => n > 0)) return;

  // Start each cycle from a blank state
  setStrokesAnimated([false, false, false, false]);
  setFillsVisible([false, false, false, false]);

  const timeouts = [];
  let totalDelay = 0;

  // Animate each path in order: stroke, then fill
  paths.forEach((item, i) => {
    timeouts.push(
      setTimeout(() => {
        setStrokesAnimated(prev => {
          const arr = [...prev];
          arr[i] = true;
          return arr;
        });
      }, totalDelay)
    );
    totalDelay += item.duration;

    timeouts.push(
      setTimeout(() => {
        setFillsVisible(prev => {
          const arr = [...prev];
          arr[i] = true;
          return arr;
        });
      }, totalDelay)
    );

    // Pause 150 ms after each fill, except the last one pauses for 5 s
    totalDelay += i === paths.length - 1 ? 5000 : 150;
  });

  // Briefly clear everything, then bump cycle to restart the schedule
  timeouts.push(
    setTimeout(() => {
      setStrokesAnimated([false, false, false, false]);
      setFillsVisible([false, false, false, false]);
    }, totalDelay)
  );

  // Kick off next loop by incrementing cycle (this retriggers the effect)
  timeouts.push(
    setTimeout(() => {
      setCycle(c => c + 1);
    }, totalDelay) // tiny gap so the blank frame is visible
  );

  return () => timeouts.forEach(clearTimeout);
}, [lengths, cycle]);


  return (
    <svg width="120" height="42" viewBox="0 0 271 94" fill="none" className={className} style={style} xmlns="http://www.w3.org/2000/svg">
      {paths.map((p, i) => (
        <g key={i}>
          {/* Stroke animation (handwriting effect) */}
          <path
            ref={el => (pathsRef.current[i] = el)}
            d={p.d}
            stroke={p.color}
            strokeWidth={2.7}
            fill="none"
            strokeDasharray={lengths[i]}
            strokeDashoffset={strokesAnimated[i] ? 0 : lengths[i]}
            style={{
              transition: `stroke-dashoffset ${p.duration}ms cubic-bezier(.5,0,.5,1)`,
            }}
            strokeLinecap="round"
            strokeLinejoin="round"
          />
          {/* Fill 'coloring' reveal animation */}
          <path
            d={p.d}
            fill={p.color}
            stroke="none"
            style={{
              opacity: fillsVisible[i] ? 1 : 0,
              transition: `opacity 0.33s ease`,
            }}
          />
        </g>
      ))}
    </svg>
  );
}
